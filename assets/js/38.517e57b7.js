(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{724:function(t,s,a){t.exports=a.p+"assets/img/image-20250427223746587.f868931f.png"},725:function(t,s,a){t.exports=a.p+"assets/img/image-20250427223937047.bbf66e34.png"},726:function(t,s,a){t.exports=a.p+"assets/img/AI-Web.f956f6f9.gif"},727:function(t,s,a){t.exports=a.p+"assets/img/image-20250427225009055.8412d67a.png"},728:function(t,s,a){t.exports=a.p+"assets/img/image-20250427225510037.43bb6485.png"},850:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_09-第一次对话完善"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_09-第一次对话完善"}},[t._v("#")]),t._v(" 09.第一次对话完善")]),t._v(" "),s("p",[t._v("第一次对话时，创建后再"),s("strong",[t._v("自动发送对话内容")])]),t._v(" "),s("h2",{attrs:{id:"第一次对话完善"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第一次对话完善"}},[t._v("#")]),t._v(" 第一次对话完善")]),t._v(" "),s("p",[t._v("第一次对话时，会创建第一次对话的消息为标题的页面")]),t._v(" "),s("p",[t._v("但并没有将第一次对话的内容发送给大模型")]),t._v(" "),s("p",[t._v("进行优化")]),t._v(" "),s("p",[t._v("在"),s("code",[t._v("src/app/chat/[chat_id]/page.tsx")]),t._v("页面")]),t._v(" "),s("p",[t._v("如果chat的data的title存在，并且这个chat没有历史数据")]),t._v(" "),s("p",[s("img",{attrs:{src:a(724),alt:"image-20250427223746587"}}),t._v("在useChat的hook里添加append，调用后端API 向聊天历史中添加（追加）新的消息"),s("img",{attrs:{src:a(725),alt:"image-20250427223937047"}})]),t._v(" "),s("p",[t._v("补充代码 增加的内容即第一次对话时传递的title")]),t._v(" "),s("div",{staticClass:"language-tsx line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-tsx"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("handleFirstMessage")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("title "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" previousMessages"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("length "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                role"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                content"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" chat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("title\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                model"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("model"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                chat_id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("chat_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                chat_user_id"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" chat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("userId\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("p",[t._v("使用useEffect钩子，页面渲染时触发此函数")]),t._v(" "),s("div",{staticClass:"language-tsx line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-tsx"}},[s("code",[t._v("    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("handleFirstMessage")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("useEffect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleFirstMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("chat"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("data"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("previousMessages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("h2",{attrs:{id:"项目1-0运行效果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目1-0运行效果"}},[t._v("#")]),t._v(" "),s("strong",[t._v("项目1.0运行效果")])]),t._v(" "),s("p",[s("img",{attrs:{src:a(726),alt:"AI-Web"}})]),t._v(" "),s("h2",{attrs:{id:"模型切换"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模型切换"}},[t._v("#")]),t._v(" 模型切换")]),t._v(" "),s("p",[t._v("将model参数传入数据库，供后续更改模型")]),t._v(" "),s("p",[s("img",{attrs:{src:a(727),alt:"image-20250427225009055"}})]),t._v(" "),s("h2",{attrs:{id:"待更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#待更新"}},[t._v("#")]),t._v(" 待更新")]),t._v(" "),s("p",[t._v("页面渲染问题")]),t._v(" "),s("p",[t._v("对话返回的是markdown格式，我们尚未把markdown格式的文本按原格式渲染出来")]),t._v(" "),s("p",[s("img",{attrs:{src:a(728),alt:"image-20250427225510037"}})]),t._v(" "),s("p",[s("em",[t._v("文字写于：广东")])])])}),[],!1,null,null,null);s.default=e.exports}}]);